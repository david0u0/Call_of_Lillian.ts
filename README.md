## 各事件流程
* 當一張卡從場上退場
    - 卡.card_retire_chain -> 世界.retire_chain -> 卡.card_leave_chain
* 當一張卡從場上消滅
    - 卡.card_leave_chain
* 計算角色、場地、事件的費用
    - 卡.get_mana_cost_chain -> 世界.get_mana_cost_chain
* 計算升級卡的費用
    - 卡.get_mana_cost_chain -> 世界.get_mana_cost_chain -> 世界.get_upgrade_cost_chain

## 戰鬥流程

### 宣戰
花費一個行動，指定一個有敵方角色存在的場所為主戰場，支付宣戰代價（默認為一點情緒傷害）進行宣戰。

### 參戰角色
與主戰場鄰接的場所中，除了本回合剛進入場所的角色，所有角色暫時解除疲勞狀態。
如果宣戰方沒有角色可以解除疲勞，則不可宣戰。  

### 攻擊與格擋
由攻擊方選擇一至N個角色，並選擇一個主戰場中的角色做為攻擊對象。
只有滿足下列條件的角色才可用於進攻：

* 不可為疲勞狀態
* 戰力不可為0
* 不可帶有「堅守」效果

隨後，防守方可以選擇至多N個角色進行格擋。
只有滿足下列條件的角色才可進行格擋：

* 不可為疲勞狀態
* 戰力不可為0
* 不可以是被指定為攻擊對象的角色

由防守玩家方指定每個角色格擋的對象。
此外，擁有「狙擊」效果的角色不可被格擋。

在進攻者與格擋者安排完畢之後，如果尚有進攻角色未被格擋，則由先前指定的對象承受其餘的攻擊。
接著進行一至多次衝突階段。

#### 衝突
* 一個進攻者 v.s. 一個角色
    - 進行戰力比較，輸的一方被擊退，贏的一方則進入疲勞狀態。若戰力相等，兩者皆被擊退。
* 多個進攻者 v.s. 一個角色：由防守方決定順序，依次進行一對一衝突，直至其中一方被全數擊退。
    - 若進攻角色的戰力勝出，則擊退防守角色。
    - 若雙方戰力相等，兩者皆被擊退。
    - 若防守角色的戰力勝出，則擊退進攻角色，同時自身的戰力減去方才進攻角色的戰力。

衝突之後，所有參與衝突的角色皆進入疲勞。

若此時攻擊方尚有角色可進攻，防守方也有角色可被指定為對象，則進攻方可以選擇重複__攻擊與格擋__的流程。
否則進入終戰階段。

### 終戰
所有參戰角色恢復為疲勞狀態。